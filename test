
import http from 'k6/http';
import { check, group, sleep } from 'k6';
const applep12_assets = [
'https://applep12.com/js/optimized-language-detection.js',
'https://applep12.com/assets/fonts/inter-v13-latin-400.woff2',
'https://applep12.com/assets/fonts/inter-v13-latin-600.woff2',
'https://applep12.com/assets/css/critical.css',
'https://applep12.com/assets/js/critical.js',
'https://applep12.com/assets/js/performance-monitor.js',
'https://applep12.com/assets/css/components.css',
'https://applep12.com/sw-enhanced.js',
'https://applep12.com/pagespeed_static/1.JiBnMqyl6S.gif',
'https://applep12.com/assets/vendor/slick/slick.min.js',
'https://applep12.com/assets/js/progressive-content-loader.js',
'https://applep12.com/assets/js/head.built.js',
'https://applep12.com/assets/js/main.built.js',
'https://applep12.com/assets/image/logo/logo-cert.png',
'https://applep12.com/assets/image/nganhang/xbinance.png.pagespeed.ic.MCCXlGvND_.png',
'https://applep12.com/assets/image/nganhang/xpaypal.png.pagespeed.ic.XsR0vxB3Mc.png',
'https://applep12.com/assets/image/nganhang/xvietqr.png.pagespeed.ic.SFH5YdBSn8.png',
'https://applep12.com/assets/image/banner/BANNED.png',
'https://applep12.com/manifest.json',
'https://applep12.com/browserconfig.xml',
'https://applep12.com/sitemap.xml',
];

const certapple_assets = [
'https://certapple.com/assets/css/style.css',
'https://certapple.com/assets/css/custom.css',
'https://certapple.com/assets/css/bootstrap-icons.css',
'https://certapple.com/assets/css/swiper.min.css',
'https://certapple.com/assets/css/toastr.min.css',
'https://certapple.com/assets/js/jquery.min.js',
'https://certapple.com/assets/js/swiper.min.js',
'https://certapple.com/assets/js/toastr.min.js',
'https://certapple.com/assets/js/moment.min.js',
'https://certapple.com/assets/js/jquery.lazyload.min.js',
'https://certapple.com/assets/js/custom.js',
'https://certapple.com/assets/fonts/inter-v13-latin-400.woff2',
'https://certapple.com/assets/fonts/inter-v13-latin-600.woff2',
'https://certapple.com/assets/vendor/web-vitals/web-vitals.iife.js',
'https://certapple.com/assets/css/critical.css',
'https://certapple.com/assets/js/critical.js',
'https://certapple.com/assets/js/performance-monitor.js',
'https://certapple.com/assets/css/components.css',
'https://certapple.com/assets/vendor/slick/slick.css',
'https://certapple.com/assets/vendor/slick/slick-theme.min.css',
'https://certapple.com/assets/css/progressive-loading.css',
'https://certapple.com/assets/vendor/slick/slick.min.js',
'https://certapple.com/assets/js/progressive-content-loader.js',
'https://certapple.com/assets/js/head.built.js',
'https://certapple.com/assets/js/main.built.js',
'https://certapple.com/assets/image/logo/apple-icon-57x57.png',
'https://certapple.com/assets/image/logo/apple-icon-60x60.png',
'https://certapple.com/assets/image/logo/apple-icon-72x72.png',
'https://certapple.com/assets/image/logo/apple-icon-76x76.png',
'https://certapple.com/assets/image/logo/apple-icon-114x114.png',
'https://certapple.com/assets/image/logo/apple-icon-120x120.png',
'https://certapple.com/assets/image/logo/apple-icon-144x144.png',
'https://certapple.com/assets/image/logo/apple-icon-152x152.png',
'https://certapple.com/assets/image/logo/apple-icon-180x180.png',
'https://certapple.com/assets/image/logo/android-icon-192x192.png',
'https://certapple.com/assets/image/logo/favicon-32x32.png',
'https://certapple.com/assets/image/logo/favicon-96x96.png',
'https://certapple.com/assets/image/logo/favicon-16x16.png',
'https://certapple.com/assets/image/logo/favicon.ico',
'https://certapple.com/assets/image/logo/ms-icon-144x144.png',
'https://certapple.com/assets/image/logo/logo.png',
'https://certapple.com/assets/image/icons/icon-144x144.png',
'https://certapple.com/assets/image/favicon/favicon.svg',
'https://certapple.com/assets/image/favicon/favicon-32x32.png',
'https://certapple.com/assets/image/favicon/favicon-16x16.png',
'https://certapple.com/apple-touch-icon-180x180.png',
'https://certapple.com/assets/image/icon/linked.png',
'https://certapple.com/manifest.json',
'https://certapple.com/browserconfig.xml',
'https://certapple.com/feed.xml',
'https://certapple.com/atom.xml',
'https://certapple.com/sitemap-index.xml',
'https://certapple.com/opensearch.xml',
'https://certapple.com/rss.xml',
];

const other_assets = [
'https://h5m4.c19.e2-1.dev/image-video/logo/logocertapple.png',
'https://h5m4.c19.e2-1.dev/image-video/banner/certappleogi.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/logodyklib.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/telegram-logosvg.webp',
'https://h5m4.c19.e2-1.dev/image-video/blog/social-01-512.webp',
'https://h5m4.c19.e2-1.dev/image-video/blog/facebook-messenger-logo-2020svg.webp',
'https://h5m4.c19.e2-1.dev/image-video/blog/discord-round-color-icon.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-93-at-4x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/blacklist.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/saleunban.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/premium-1.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/24h.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/standard-1.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/basic-1.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-129-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-125-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-126-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-130-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-127-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-128-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/asset-124-at-7x.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/testflight.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/enterprise.png',
'https://h5m4.c19.e2-1.dev/image-video/ios-18-iphone-15-pro-settings-face-id-passcode-stolen-device-protection-1.png',
'https://h5m4.c19.e2-1.dev/image-video/image.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/devloper-1.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/banneresign.png',
'https://h5m4.c19.e2-1.dev/image-video/blog/certapple-api-services-user-data-policy-1.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/application-privacy-policy.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/principles-of-trademark-use.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/api-terms-of-service.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/affiliate-marketing-program.jpg',
'https://h5m4.c19.e2-1.dev/image-video/blog/escrow-agency-program.jpg',
];

export const options = {
stages: [
{ duration: '2s', target: 1000 },
{ duration: '900m', target: 1000 },
{ duration: '5m', target: 0 },
],
thresholds: {
'http_req_duration': ['p(95)<800'],
'http_req_failed': ['rate<0.01'],
'checks': ['rate>0.98'],
},
};

export default function () {
group('Hành trình người dùng trên applep12.com', function () {
const applep12_responses = http.batch(applep12_assets.map(url => ['GET', url]));
applep12_responses.forEach(res => {
check(res, {
'applep12 asset status is 200': (r) => r.status === 200,
});
});

group('API actions for applep12', function () {
const loginPayload = JSON.stringify({ email: `user-${__VU}@test.com`, password: 'password123' });
const loginParams = { headers: { 'Content-Type': 'application/json' } };
const loginRes = http.post('https://applep12.com/login_post', loginPayload, loginParams);
check(loginRes, {
'login post status is 200 or 4xx': (r) => r.status === 200 || (r.status >= 400 && r.status < 500),
});
});
});
group('Hành trình người dùng trên certapple.com', function () {
const certapple_responses = http.batch(certapple_assets.map(url => ['GET', url]));
certapple_responses.forEach(res => {
check(res, {
'certapple asset status is 200': (r) => r.status === 200,
});
});

const feedRes = http.get('https://certapple.com/api/feed.json');
check(feedRes, {
'certapple feed API status is 200': (r) => r.status === 200,
});
});

group('Tải tài nguyên từ CDN khác', function () {
const other_responses = http.batch(other_assets.map(url => ['GET', url]));
other_responses.forEach(res => {
check(res, {
'other assets status is 200': (r) => r.status === 200,
});
});
});
sleep(0);
}
