# .github/workflows/Scheduler.yml

name: Schedule and Trigger k6 Tests

on:
  schedule:
    - cron: '*/4 * * * *'
  workflow_dispatch:

jobs:
  # Tên job này không quan trọng, có thể đặt là gì cũng được
  call-reusable-k6-test:
    # THAY ĐỔI LỚN NHẤT:
    # 'uses' được đặt ở đây, cấp độ JOB, để gọi một Reusable Workflow.
    # Nó thay thế hoàn toàn cho 'runs-on' và 'steps'.
    uses: ./.github/workflows/Test.yml
    
    # Dùng strategy để gọi job này 10 lần
    strategy:
      fail-fast: false
      matrix:
        # Chúng ta chỉ cần một biến để lặp 10 lần, không cần dùng đến nó
        run_number: [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]

    # Dùng 'with' để truyền input cho workflow được gọi
    with:
      target_url: 'https://certapple.com'
      
    # Best practice: Cho phép workflow được gọi sử dụng secrets của workflow này
    secrets: inherit

